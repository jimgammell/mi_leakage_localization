import numpy as np

from utils.performance_correlation import MeasurePerformanceCorrelation

def evaluate_gmm_exploitability(profiling_dataset, attack_dataset, leakage_assessment, poi_count=20, fast=False):
    dataset_name = profiling_dataset.__class__.__name__
    if dataset_name == 'ASCADv1':
        targets = ['subbytes__r_out', 'r_out']
    else:
        targets = ['label']
    metric = MeasurePerformanceCorrelation(np.abs(leakage_assessment), profiling_dataset, attack_dataset, target_keys=targets)
    corr, means, _ = metric.measure_performance(poi_count=poi_count, fast=fast)
    return corr, means